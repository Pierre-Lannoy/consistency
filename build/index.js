(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var s in n)e.o(n,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.plugins,n=window.wp.data,s=window.wp.coreData,o=window.wp.domReady;var i=e.n(o);const r=["core/paragraph","core/heading","core/quote","core/list-item","core/freeform","core/read-more"],c=[{name:"quote",mask:/\'/g,replace:"’",nbMoved:0,locales:["fr_FR","fr_BE","en_US","en_AU","en_CA","en_NZ","en_ZA","en_GB"]},{name:"ellipsis",mask:/\.{3}/g,replace:"…",nbMoved:-2,locales:["fr_FR","fr_BE","en_US","en_AU","en_CA","en_NZ","en_ZA","en_GB"]},{name:"2hyphens",mask:/\-{2}/g,replace:"—",nbMoved:-1,locales:["fr_FR","fr_BE","en_US","en_AU","en_CA","en_NZ","en_ZA","en_GB"]},{name:"ordinalNumberSuffix",mask:/([10-9]{1,20})(th|nd|rd|e|er|res|d|ds|de|des)(?= | )/g,replace:"$1<sup>$2</sup>",nbMoved:0,locales:["fr_FR","fr_BE","en_US","en_AU","en_CA","en_NZ","en_ZA","en_GB"]},{name:"regularToCurlyQuotes",mask:/"([^"]*)"/g,replace:"“$1”",nbMoved:0,locales:["en_US","en_AU","en_CA","en_NZ","en_ZA","en_GB"]},{name:"regularToFrenchQuotes",mask:/"([^"]*)"/g,replace:"« $1 »",nbMoved:2,locales:["fr_FR","fr_BE"]},{name:"breakingSpace",mask:/ (?=[\?|\!|\:|\;|\»|\€|\$|\£|\¥|\₽|\元|\%])/g,replace:" ",nbMoved:0,locales:["fr_FR","fr_BE"]},{name:"noSpaceBefore",mask:/(?<! | |&nbsp;)([\?|\!|\:|\»|\€|\$|\£|\¥|\₽|\元|\%])/g,replace:" $1",nbMoved:1,locales:["fr_FR","fr_BE"]},{name:"noNonBreakingSpaceAfter",mask:/(«)(?! | |&nbsp;)/g,replace:"$1 ",nbMoved:0,locales:["fr_FR","fr_BE"]},{name:"noBreakingSpaceAfter",mask:/([\,|\…|\)|\]])(?! | |\.|\,|\d)/g,replace:"$1 ",nbMoved:1,locales:["fr_FR","fr_BE","en_US","en_AU","en_CA","en_NZ","en_ZA","en_GB"]},{name:"spaceBefore",mask:/([ | ])(?=[\?|\!|\:|\;|\%])/g,replace:"",nbMoved:-1,locales:["en_US","en_AU","en_CA","en_NZ","en_ZA","en_GB"]}],l=window.wp.element,a=window.wp.components,u=()=>(0,l.createElement)(a.Icon,{icon:(0,l.createElement)("svg",{version:"1.1",id:"consistency-plugin",x:"0px",y:"0px",width:"24px",height:"24px",viewBox:"0 0 24 24",enableBackground:"new 0 0 24 24"},(0,l.createElement)("line",{fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",x1:"4",y1:"20",x2:"7",y2:"20"}),(0,l.createElement)("line",{fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",x1:"14",y1:"20",x2:"21",y2:"20"}),(0,l.createElement)("line",{fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",x1:"6.9",y1:"15",x2:"13.8",y2:"15"}),(0,l.createElement)("line",{fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",x1:"10.2",y1:"6.3",x2:"16",y2:"20"}),(0,l.createElement)("polyline",{fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",points:"5,20 11,4 13,4 20,20 "}))}),d=window.wp.i18n,p=window.wp.editPost,{canUser:_}=(0,n.select)("core"),g=window.wp.notices,m=()=>{const{currentUser:e}=(0,n.useSelect)((e=>({currentUser:e(s.store).getCurrentUser()})),[]),t=e&&e.id,[o,i]=(0,s.useEntityProp)("root","user","meta",t),{saveEditedEntityRecord:r}=(0,n.useDispatch)(s.store),{createNotice:c}=(0,n.useDispatch)(g.store);return(0,l.createElement)(a.ToggleControl,{label:(0,d.__)("Consistency Correction","consistency"),help:(0,d.__)("Turn on/off autocorrect for my account","consistency"),checked:o?.consistency_plugin_setting_state[0]||!1,onChange:e=>{i({consistency_plugin_setting_state:[e]}),r("root","user",t,{consistency_plugin_setting_state:[e]}),c((0,d.__)("info","consistency"),e?(0,d.__)("Consistency Correction is enabled","consistency"):(0,d.__)("Consistency Correction is disabled","consistency"),{isDismissible:!0,type:"snackbar",speak:!0,explicitDismiss:!0})}})},y=e=>{const t=f(),n=c?.find((t=>t.name===e));return!(void 0===n||!n?.locales?.includes(t))},f=()=>{const{getEntityRecord:e}=(0,n.select)("core");return e("root","site")?.language||"en_US"},h=()=>{const e="quote";if(!y(e))return"";const[t,o]=(0,s.useEntityProp)("root","site","consistency_plugin_settings",void 0),{saveEditedEntityRecord:i}=(0,n.useDispatch)(s.store),{createNotice:r}=(0,n.useDispatch)(g.store);return(0,l.createElement)(a.PanelRow,null,(0,l.createElement)(a.ToggleControl,{label:(0,d.__)("Straight quote Correction","consistency"),help:(0,l.createElement)(l.Fragment,null,(0,d.__)("Replaces straight quotes with curved quotes:","consistency"),(0,l.createElement)("span",{"aria-hidden":"true",style:{display:"block"}},(0,l.createElement)("code",null,"'")," ",(0,l.createElement)("span",{style:{fontSize:"20px"}},"→")," ",(0,l.createElement)("code",null,"’"))),checked:t?.find((t=>t.slug===e))?.value||!1,onChange:n=>{let s=t.map((t=>e===t.slug?{...t,value:n}:t));s?.find((t=>t.slug===e))||s.push({slug:e,value:n}),o(s),i("root","site",void 0,s),r((0,d.__)("info","consistency"),n?(0,d.__)('"Straight quote" Correction is enabled',"consistency"):(0,d.__)('"Straight quote" Correction is disabled',"consistency"),{isDismissible:!0,type:"snackbar",speak:!0,explicitDismiss:!0})}}))},b=()=>{const e="ellipsis";if(!y(e))return"";const[t,o]=(0,s.useEntityProp)("root","site","consistency_plugin_settings",void 0),{saveEditedEntityRecord:i}=(0,n.useDispatch)(s.store),{createNotice:r}=(0,n.useDispatch)(g.store);return(0,l.createElement)(a.PanelRow,null,(0,l.createElement)(a.ToggleControl,{label:(0,d.__)("Ellipsis","consistency"),help:(0,l.createElement)(l.Fragment,null,(0,d.__)("Replaces 3 dots with ellipsis:","consistency"),(0,l.createElement)("span",{"aria-hidden":"true",style:{display:"block"}},(0,l.createElement)("code",null,"...")," ",(0,l.createElement)("span",{style:{fontSize:"20px"}},"→")," ",(0,l.createElement)("code",null,"…"))),checked:t?.find((t=>t.slug===e))?.value||!1,onChange:n=>{let s=t.map((t=>e===t.slug?{...t,value:n}:t));s?.find((t=>t.slug===e))||s.push({slug:e,value:n}),o(s),i("root","site",void 0,s),r((0,d.__)("info","consistency"),n?(0,d.__)('"Ellipsis" Correction is enabled',"consistency"):(0,d.__)('"Ellipsis" Correction is disabled',"consistency"),{isDismissible:!0,type:"snackbar",speak:!0,explicitDismiss:!0})}}))},E=()=>{const e="2hyphens";if(!y(e))return"";const[t,o]=(0,s.useEntityProp)("root","site","consistency_plugin_settings",void 0),{saveEditedEntityRecord:i}=(0,n.useDispatch)(s.store),{createNotice:r}=(0,n.useDispatch)(g.store);return(0,l.createElement)(a.PanelRow,null,(0,l.createElement)(a.ToggleControl,{label:(0,d.__)("Two hyphens","consistency"),help:(0,l.createElement)(l.Fragment,null,(0,d.__)("Replaces 2 hyphens with em dash:","consistency"),(0,l.createElement)("span",{"aria-hidden":"true",style:{display:"block"}},(0,l.createElement)("code",null,"--")," ",(0,l.createElement)("span",{style:{fontSize:"20px"}},"→")," ",(0,l.createElement)("code",null,"—"))),checked:t?.find((t=>t.slug===e))?.value||!1,onChange:n=>{let s=t.map((t=>e===t.slug?{...t,value:n}:t));s?.find((t=>t.slug===e))||s.push({slug:e,value:n}),o(s),i("root","site",void 0,s),r((0,d.__)("info","consistency"),n?(0,d.__)('"Two hyphens" Correction is enabled',"consistency"):(0,d.__)('"Two hyphens" Correction is disabled',"consistency"),{isDismissible:!0,type:"snackbar",speak:!0,explicitDismiss:!0})}}))},k=()=>{const e="ordinalNumberSuffix";if(!y(e))return"";const[t,o]=(0,s.useEntityProp)("root","site","consistency_plugin_settings",void 0),{saveEditedEntityRecord:i}=(0,n.useDispatch)(s.store),{createNotice:r}=(0,n.useDispatch)(g.store);return(0,l.createElement)(a.PanelRow,null,(0,l.createElement)(a.ToggleControl,{label:(0,d.__)("Ordinal number suffix","consistency"),help:(0,l.createElement)(l.Fragment,null,(0,d.__)("Add HTML tag sup to ordinal number suffix","consistency")),checked:t?.find((t=>t.slug===e))?.value||!1,onChange:n=>{let s=t.map((t=>e===t.slug?{...t,value:n}:t));s?.find((t=>t.slug===e))||s.push({slug:e,value:n}),o(s),i("root","site",void 0,s),r((0,d.__)("info","consistency"),n?(0,d.__)('"Ordinal number suffix" Correction is enabled',"consistency"):(0,d.__)('"Ordinal number suffix" Correction is disabled',"consistency"),{isDismissible:!0,type:"snackbar",speak:!0,explicitDismiss:!0})}}))},v=()=>{const e="breakingSpace";if(!y(e))return"";const[t,o]=(0,s.useEntityProp)("root","site","consistency_plugin_settings",void 0),{saveEditedEntityRecord:i}=(0,n.useDispatch)(s.store),{createNotice:r}=(0,n.useDispatch)(g.store);return(0,l.createElement)(a.PanelRow,null,(0,l.createElement)(a.ToggleControl,{label:(0,d.__)("Breaking space","consistency"),help:(0,l.createElement)("span",{dangerouslySetInnerHTML:{__html:sprintf((0,d.__)("Replaces a breaking space followed by a character from this list:%1$s with a non-breaking space","consistency"),"<br /><code>? ! : ; » € $ £ ¥ ₽ 元 %</code><br />")}}),checked:t?.find((t=>t.slug===e))?.value||!1,onChange:n=>{let s=t.map((t=>e===t.slug?{...t,value:n}:t));s?.find((t=>t.slug===e))||s.push({slug:e,value:n}),o(s),i("root","site",void 0,s),r((0,d.__)("info","consistency"),n?(0,d.__)('"Breaking space" Correction is enabled',"consistency"):(0,d.__)('"Breaking space" Correction is disabled',"consistency"),{isDismissible:!0,type:"snackbar",speak:!0,explicitDismiss:!0})}}))},C=()=>{const e="regularToCurlyQuotes";if(!y(e))return"";const[t,o]=(0,s.useEntityProp)("root","site","consistency_plugin_settings",void 0),{saveEditedEntityRecord:i}=(0,n.useDispatch)(s.store),{createNotice:r}=(0,n.useDispatch)(g.store);return(0,l.createElement)(a.PanelRow,null,(0,l.createElement)(a.ToggleControl,{label:(0,d.__)("Regular quotes to curly","consistency"),help:(0,l.createElement)(l.Fragment,null,(0,d.__)("Replaces regular quotes with curly quotes:","consistency"),(0,l.createElement)("span",{"aria-hidden":"true",style:{display:"block"}},(0,l.createElement)("code",null,'" "')," ",(0,l.createElement)("span",{style:{fontSize:"20px"}},"→")," ",(0,l.createElement)("code",null,"“ ”"))),checked:t?.find((t=>t.slug===e))?.value||!1,onChange:n=>{let s=t.map((t=>e===t.slug?{...t,value:n}:t));s?.find((t=>t.slug===e))||s.push({slug:e,value:n}),o(s),i("root","site",void 0,s),r((0,d.__)("info","consistency"),n?(0,d.__)('"Regular quotes to curly quotes" Correction is enabled',"consistency"):(0,d.__)('"Regular quotes to curly quotes" Correction is disabled',"consistency"),{isDismissible:!0,type:"snackbar",speak:!0,explicitDismiss:!0})}}))},w=()=>{const e="regularToFrenchQuotes";if(!y(e))return"";const[t,o]=(0,s.useEntityProp)("root","site","consistency_plugin_settings",void 0),{saveEditedEntityRecord:i}=(0,n.useDispatch)(s.store),{createNotice:r}=(0,n.useDispatch)(g.store);return(0,l.createElement)(a.PanelRow,null,(0,l.createElement)(a.ToggleControl,{label:(0,d.__)("Regular quotes to french","consistency"),help:(0,l.createElement)(l.Fragment,null,(0,d.__)("Replaces regular quotes with french quotes:","consistency"),(0,l.createElement)("span",{"aria-hidden":"true",style:{display:"block"}},(0,l.createElement)("code",null,'" "')," ",(0,l.createElement)("span",{style:{fontSize:"20px"}},"→")," ",(0,l.createElement)("code",null,"« »"))),checked:t?.find((t=>t.slug===e))?.value||!1,onChange:n=>{let s=t.map((t=>e===t.slug?{...t,value:n}:t));s?.find((t=>t.slug===e))||s.push({slug:e,value:n}),o(s),i("root","site",void 0,s),r((0,d.__)("info","consistency"),n?(0,d.__)('"Regular quotes to french quotes" Correction is enabled',"consistency"):(0,d.__)('"Regular quotes to french quotes" Correction is disabled',"consistency"),{isDismissible:!0,type:"snackbar",speak:!0,explicitDismiss:!0})}}))},R=()=>{const e="noSpaceBefore";if(!y(e))return"";const[t,o]=(0,s.useEntityProp)("root","site","consistency_plugin_settings",void 0),{saveEditedEntityRecord:i}=(0,n.useDispatch)(s.store),{createNotice:r}=(0,n.useDispatch)(g.store);return(0,l.createElement)(a.PanelRow,null,(0,l.createElement)(a.ToggleControl,{label:(0,d.__)("No space before","consistency"),help:(0,l.createElement)("span",{dangerouslySetInnerHTML:{__html:sprintf((0,d.__)("Adds a non-breaking space before a character from this list:%1$s having no space before","consistency"),"<br /><code>? ! : ; » € $ £ ¥ ₽ 元 %</code><br />")}}),checked:t?.find((t=>t.slug===e))?.value||!1,onChange:n=>{let s=t.map((t=>e===t.slug?{...t,value:n}:t));s?.find((t=>t.slug===e))||s.push({slug:e,value:n}),o(s),i("root","site",void 0,s),r((0,d.__)("info","consistency"),n?(0,d.__)('"No space before" Correction is enabled',"consistency"):(0,d.__)('"No space before" Correction is disabled',"consistency"),{isDismissible:!0,type:"snackbar",speak:!0,explicitDismiss:!0})}}))},D=()=>{const e="spaceBefore";if(!y(e))return"";const[t,o]=(0,s.useEntityProp)("root","site","consistency_plugin_settings",void 0),{saveEditedEntityRecord:i}=(0,n.useDispatch)(s.store),{createNotice:r}=(0,n.useDispatch)(g.store);return(0,l.createElement)(a.PanelRow,null,(0,l.createElement)(a.ToggleControl,{label:(0,d.__)("Space before","consistency"),help:(0,l.createElement)(l.Fragment,null,(0,d.__)("Remove any space preceding a character from this list:","consistency"),(0,l.createElement)("span",{style:{display:"block"}},(0,l.createElement)("code",null,"? ! : ; %"))),checked:t?.find((t=>t.slug===e))?.value||!1,onChange:n=>{let s=t.map((t=>e===t.slug?{...t,value:n}:t));s?.find((t=>t.slug===e))||s.push({slug:e,value:n}),o(s),i("root","site",void 0,s),r((0,d.__)("info","consistency"),n?(0,d.__)('"Space before" Correction is enabled',"consistency"):(0,d.__)('"Space before" Correction is disabled',"consistency"),{isDismissible:!0,type:"snackbar",speak:!0,explicitDismiss:!0})}}))},S=()=>{const e="noBreakingSpaceAfter";if(!y(e))return"";const[t,o]=(0,s.useEntityProp)("root","site","consistency_plugin_settings",void 0),{saveEditedEntityRecord:i}=(0,n.useDispatch)(s.store),{createNotice:r}=(0,n.useDispatch)(g.store);return(0,l.createElement)(a.PanelRow,null,(0,l.createElement)(a.ToggleControl,{label:(0,d.__)("No breaking space after","consistency"),help:(0,l.createElement)("span",{dangerouslySetInnerHTML:{__html:sprintf((0,d.__)("Adds a breaking space after a character from this list:%1$s when followed with another character","consistency"),"<br /><code>, … ) ]</code><br />")}}),checked:t?.find((t=>t.slug===e))?.value||!1,onChange:n=>{let s=t.map((t=>e===t.slug?{...t,value:n}:t));s?.find((t=>t.slug===e))||s.push({slug:e,value:n}),o(s),i("root","site",void 0,s),r((0,d.__)("info","consistency"),n?(0,d.__)('"No breaking space after" Correction is enabled',"consistency"):(0,d.__)('"No breaking space after" Correction is disabled',"consistency"),{isDismissible:!0,type:"snackbar",speak:!0,explicitDismiss:!0})}}))},B=()=>{const e="noNonBreakingSpaceAfter";if(!y(e))return"";const[t,o]=(0,s.useEntityProp)("root","site","consistency_plugin_settings",void 0),{saveEditedEntityRecord:i}=(0,n.useDispatch)(s.store),{createNotice:r}=(0,n.useDispatch)(g.store);return(0,l.createElement)(a.PanelRow,null,(0,l.createElement)(a.ToggleControl,{label:(0,d.__)("No non breaking space after","consistency"),help:(0,d.__)("Adds a non-breaking space after open french quote having no space after","consistency"),checked:t?.find((t=>t.slug===e))?.value||!1,onChange:n=>{let s=t.map((t=>e===t.slug?{...t,value:n}:t));s?.find((t=>t.slug===e))||s.push({slug:e,value:n}),o(s),i("root","site",void 0,s),r((0,d.__)("info","consistency"),n?(0,d.__)('"No non breaking space after" Correction is enabled',"consistency"):(0,d.__)('"No non breaking space after" Correction is disabled',"consistency"),{isDismissible:!0,type:"snackbar",speak:!0,explicitDismiss:!0})}}))},{getBlockName:x,getBlockAttributes:A,getSelectionStart:N}=(0,n.select)("core/block-editor"),{updateBlock:P,selectionChange:q}=(0,n.dispatch)("core/block-editor");let M=!1,T=[];const U=["core/paragraph","core/heading","core/quote","core/freeform","core/read-more"],{getBlocks:F,getSelectedBlockClientId:L}=(0,n.select)("core/block-editor"),{getEntityRecord:Z}=(0,n.select)("core"),{updateBlockAttributes:$,selectBlock:I,resetSelection:O}=(0,n.dispatch)("core/block-editor");(0,t.registerPlugin)("consistency-custom-sidebar",{render:()=>{const e=_("create","users");return(0,l.createElement)(l.Fragment,null,(0,l.createElement)(p.PluginSidebar,{name:"consistency-custom-sidebar",title:(0,d.__)("Consistency Settings","consistency"),icon:u},(0,l.createElement)(a.PanelBody,{title:(0,d.__)("Status","consistency"),initialOpen:!0},(0,l.createElement)(a.PanelRow,null,(0,l.createElement)(m,null))),e&&(0,l.createElement)(a.PanelBody,{title:(0,d.__)("Global Corrections","consistency"),initialOpen:!0},(0,l.createElement)(h,null),(0,l.createElement)(b,null),(0,l.createElement)(E,null),(0,l.createElement)(k,null),(0,l.createElement)(C,null),(0,l.createElement)(w,null),(0,l.createElement)(v,null),(0,l.createElement)(R,null),(0,l.createElement)(S,null),(0,l.createElement)(B,null),(0,l.createElement)(D,null))),(0,l.createElement)(p.PluginSidebarMoreMenuItem,{target:"consistency-custom-sidebar"},(0,d.__)("Consistency Settings","consistency")))}}),i()((()=>{document.querySelector(" #editor ")?.addEventListener("paste",(e=>{M=!0,e.preventDefault()})),(0,n.subscribe)((()=>{const e=(0,n.select)(s.store).getCurrentUser();if(!Z("root","user",e?.id||0,"consistency_plugin_setting_state")?.meta?.consistency_plugin_setting_state[0])return;const t=Z("root","site")?.consistency_plugin_settings;if(void 0===t)return;if(T=c.filter((e=>!0===t?.find((t=>t.slug===e.name))?.value)),M)return void(()=>{const e=F(),t=e.flatMap((e=>{let{innerBlocks:t,...n}=e;return t.map((e=>({...n,...e})))})),n=e.reduce(((e,t)=>{let n=t.attributes?.content;return Object.entries(T).forEach((e=>{let[s,o]=e;U.includes(t.name)&&void 0!==n&&y(o.name)&&(n=n.replaceAll(o.mask,o.replace))})),void 0!==n&&U.includes(t.name)?(e[t.clientId]={content:n},e):e}),{});Object.keys(n).length&&M&&(M=!1,$(Object.keys(n),n,!0)),t.forEach((e=>{U.includes(e.name)||e?.clientId&&I(e.clientId)})),t&&t[0]&&O(t[0]?.clientId,t[0]?.clientId)})();const o=L();null!==o&&T&&(e=>{const{currentBlockId:t,theRegs:n}=e,s=x(t);if(!r.includes(s))return;let o=A(t);o&&o.hasOwnProperty("content")&&""!==o.content&&Object.entries(n).forEach((e=>{let[n,i]=e;if(!i.mask.test(o.content)||!y(i.name))return;const r=0!==i.nbMoved,c=N(s);o.content=o.content.replaceAll(i.mask,i.replace),P(t,o),r&&i.nbMoved<0&&r&&q(t,c.attributeKey,c.offset-1,c.offset+i.nbMoved),r&&i.nbMoved>0&&r&&q(t,c.attributeKey,c.offset+1+i.nbMoved,c.offset+i.nbMoved)}))})({currentBlockId:o,theRegs:T})}))}))})();