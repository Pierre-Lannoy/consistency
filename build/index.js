(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var s in n)e.o(n,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.plugins,n=window.wp.data,s=window.wp.coreData,o=window.wp.domReady;var r=e.n(o);const c=["core/paragraph","core/heading","core/quote","core/list-item","core/freeform","core/read-more"],i=[{name:"quote",mask:/\'/g,replace:"’",nbMoved:0,locales:["fr_FR","fr_BE","en_US","en_AU","en_CA","en_NZ","en_ZA","en_GB"]},{name:"ellipsis",mask:/\.{3}/g,replace:"…",nbMoved:-2,locales:["fr_FR","fr_BE","en_US","en_AU","en_CA","en_NZ","en_ZA","en_GB"]},{name:"2hyphens",mask:/\-{2}/g,replace:"—",nbMoved:-1,locales:["fr_FR","fr_BE","en_US","en_AU","en_CA","en_NZ","en_ZA","en_GB"]},{name:"ordinalNumberSuffix",mask:/([10-9]{1,20})(th|nd|rd|e|er|res|d|ds|de|des)(?= | )/g,replace:"$1<sup>$2</sup>",nbMoved:0,locales:["fr_FR","fr_BE","en_US","en_AU","en_CA","en_NZ","en_ZA","en_GB"]},{name:"regularToCurlyQuotes",mask:/"([^"]*)"/g,replace:"“$1”",nbMoved:0,locales:["en_US","en_AU","en_CA","en_NZ","en_ZA","en_GB"]},{name:"regularToFrenchQuotes",mask:/"([^"]*)"/g,replace:"« $1 »",nbMoved:2,locales:["fr_FR","fr_BE"]},{name:"breakingSpace",mask:/ (?=[\?|\!|\:|\;|\»|\€|\$|\£|\¥|\₽|\元|\%])/g,replace:" ",nbMoved:0,locales:["fr_FR","fr_BE"]},{name:"noSpaceBefore",mask:/(?<! | |&nbsp;)([\?|\!|\:|\»|\€|\$|\£|\¥|\₽|\元|\%])/g,replace:" $1",nbMoved:1,locales:["fr_FR","fr_BE"]},{name:"noNonBreakingSpaceAfter",mask:/(«)(?! | |&nbsp;)/g,replace:"$1 ",nbMoved:0,locales:["fr_FR","fr_BE"]},{name:"noBreakingSpaceAfter",mask:/([\,|\…|\)|\]])(?! | |\.|\,|\d)/g,replace:"$1 ",nbMoved:1,locales:["fr_FR","fr_BE","en_US","en_AU","en_CA","en_NZ","en_ZA","en_GB"]},{name:"spaceBefore",mask:/([ | ])(?=[\?|\!|\:|\;|\%])/g,replace:"",nbMoved:-1,locales:["en_US","en_AU","en_CA","en_NZ","en_ZA","en_GB"]}],a=window.wp.element,l=window.wp.i18n,d=window.wp.editPost,p=window.wp.components,_=()=>(0,a.createElement)(p.Icon,{icon:(0,a.createElement)("svg",{version:"1.1",id:"consistency-plugin",x:"0px",y:"0px",width:"24px",height:"24px",viewBox:"0 0 24 24",enableBackground:"new 0 0 24 24"},(0,a.createElement)("line",{fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",x1:"4",y1:"20",x2:"7",y2:"20"}),(0,a.createElement)("line",{fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",x1:"14",y1:"20",x2:"21",y2:"20"}),(0,a.createElement)("line",{fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",x1:"6.9",y1:"15",x2:"13.8",y2:"15"}),(0,a.createElement)("line",{fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",x1:"10.2",y1:"6.3",x2:"16",y2:"20"}),(0,a.createElement)("polyline",{fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",points:"5,20 11,4 13,4 20,20 "}))}),u=window.wp.notices,g=()=>{const{currentUser:e}=(0,n.useSelect)((e=>({currentUser:e(s.store).getCurrentUser()})),[]),t=e&&e.id,[o,r]=(0,s.useEntityProp)("root","user","meta",t),{saveEditedEntityRecord:c}=(0,n.useDispatch)(s.store),{createNotice:i}=(0,n.useDispatch)(u.store);return(0,a.createElement)(p.ToggleControl,{label:(0,l.__)("Consistency Correction","consistency"),help:(0,l.__)("Turn on/off autocorrect for my account","consistency"),checked:o?.consistency_plugin_setting_state[0]||!1,onChange:e=>{r({consistency_plugin_setting_state:[e]}),c("root","user",t,{consistency_plugin_setting_state:[e]}),i((0,l.__)("info","consistency"),e?(0,l.__)("Consistency Correction is enabled","consistency"):(0,l.__)("Consistency Correction is disabled","consistency"),{isDismissible:!0,type:"snackbar",speak:!0,explicitDismiss:!0})}})},m=e=>{const t=y(),n=i?.find((t=>t.name===e));return!(void 0===n||!n?.locales?.includes(t))},y=()=>{const{getEntityRecord:e}=(0,n.select)("core");return e("root","site")?.language||"en_US"},f=e=>{const{settingSlug:t,settingName:o,settingDescription:r}=e;if(!m(t))return"";const[c,i]=(0,s.useEntityProp)("root","site","consistency_plugin_settings",void 0),{saveEditedEntityRecord:d}=(0,n.useDispatch)(s.store),{createNotice:_}=(0,n.useDispatch)(u.store);return(0,a.createElement)(p.PanelRow,null,(0,a.createElement)(p.ToggleControl,{label:o,help:(0,a.createElement)("span",{dangerouslySetInnerHTML:r}),checked:c?.find((e=>e.slug===t))?.value||!1,onChange:e=>{let n=c.map((n=>t===n.slug?{...n,value:e}:n));n?.find((e=>e.slug===t))||n.push({slug:t,value:e}),i(n),d("root","site",void 0,n),_((0,l.__)("info","consistency"),e?sprintf((0,l.__)('"%1$s" Correction is enabled',"consistency"),o):sprintf((0,l.__)('"%1$s" Correction is disabled',"consistency"),o),{isDismissible:!0,type:"snackbar",speak:!0})}}))},{canUser:h}=(0,n.select)("core"),{getBlockName:b,getBlockAttributes:k,getSelectionStart:E}=(0,n.select)("core/block-editor"),{updateBlock:S,selectionChange:w}=(0,n.dispatch)("core/block-editor");let v=!1,B=[];const A=["core/paragraph","core/heading","core/quote","core/freeform","core/read-more"],{getBlocks:C,getSelectedBlockClientId:N}=(0,n.select)("core/block-editor"),{getEntityRecord:R}=(0,n.select)("core"),{updateBlockAttributes:x,selectBlock:M,resetSelection:D}=(0,n.dispatch)("core/block-editor");(0,t.registerPlugin)("consistency-custom-sidebar",{render:()=>{const e=h("create","users");return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(d.PluginSidebar,{name:"consistency-custom-sidebar",title:(0,l.__)("Consistency Settings","consistency"),icon:_},(0,a.createElement)(p.PanelBody,{title:(0,l.__)("Status","consistency"),initialOpen:!0},(0,a.createElement)(p.PanelRow,null,(0,a.createElement)(g,null))),e&&(0,a.createElement)(p.PanelBody,{title:(0,l.__)("Global Corrections","consistency"),initialOpen:!0},(0,a.createElement)(f,{settingSlug:"quote",settingName:(0,l.__)("Straight quote","consistency"),settingDescription:{__html:(0,l.__)("Replaces straight quotes with curved quotes:","consistency")+"<span aria-hidden='true' style='display:block;'><code>'</code> <span style='font-size:20px'>→</span> <code>’</code></span>"}}),(0,a.createElement)(f,{settingSlug:"ellipsis",settingName:(0,l.__)("Ellipsis","consistency"),settingDescription:{__html:(0,l.__)("Replaces 3 dots with ellipsis:","consistency")+"<span aria-hidden='true' style={ { display: 'block' } }><code>...</code> <span style={ { fontSize: '20px' } }>→</span> <code>…</code></span>"}}),(0,a.createElement)(f,{settingSlug:"2hyphens",settingName:(0,l.__)("Two hyphens","consistency"),settingDescription:{__html:(0,l.__)("Replaces 2 hyphens with em dash:","consistency")+"<span aria-hidden='true' style={ { display: 'block' } }><code>--</code> <span style={ { fontSize: '20px' } }>→</span> <code>—</code></span>"}}),(0,a.createElement)(f,{settingSlug:"ordinalNumberSuffix",settingName:(0,l.__)("Ordinal number suffix","consistency"),settingDescription:{__html:(0,l.__)("Add HTML tag sup to ordinal number suffix","consistency")}}),(0,a.createElement)(f,{settingSlug:"regularToCurlyQuotes",settingName:(0,l.__)("Regular quotes to curly","consistency"),settingDescription:{__html:(0,l.__)("Replaces regular quotes with curly quotes:","consistency")+"<span aria-hidden='true' style={ { display: 'block' } }><code>\" \"</code> <span style={ { fontSize: '20px' } }>→</span> <code>“ ”</code></span>"}}),(0,a.createElement)(f,{settingSlug:"regularToFrenchQuotes",settingName:(0,l.__)("Regular quotes to french","consistency"),settingDescription:{__html:(0,l.__)("Replaces regular quotes with french quotes:","consistency")+"<span aria-hidden='true' style={ { display: 'block' } }><code>\" \"</code> <span style={ { fontSize: '20px' } }>→</span> <code>« »</code></span>"}}),(0,a.createElement)(f,{settingSlug:"breakingSpace",settingName:(0,l.__)("Breaking space","consistency"),settingDescription:{__html:sprintf((0,l.__)("Replaces a breaking space followed by a character from this list:%1$s with a non-breaking space","consistency"),"<br /><code>? ! : ; » € $ £ ¥ ₽ 元 %</code><br />")}}),(0,a.createElement)(f,{settingSlug:"noSpaceBefore",settingName:(0,l.__)("No space before","consistency"),settingDescription:{__html:sprintf((0,l.__)("Adds a non-breaking space before a character from this list:%1$s having no space before","consistency"),"<br /><code>? ! : ; » € $ £ ¥ ₽ 元 %</code><br />")}}),(0,a.createElement)(f,{settingSlug:"noBreakingSpaceAfter",settingName:(0,l.__)("No breaking space after","consistency"),settingDescription:{__html:sprintf((0,l.__)("Adds a breaking space after a character from this list:%1$s when followed with another character","consistency"),"<br /><code>, … ) ]</code><br />")}}),(0,a.createElement)(f,{settingSlug:"noNonBreakingSpaceAfter",settingName:(0,l.__)("No non breaking space after","consistency"),settingDescription:{__html:(0,l.__)("Adds a non-breaking space after open french quote having no space after","consistency")}}),(0,a.createElement)(f,{settingSlug:"spaceBefore",settingName:(0,l.__)("Space before","consistency"),settingDescription:{__html:(0,l.__)("Remove any space preceding a character from this list:","consistency")+"<span style={ { display: 'block' } }><code>? ! : ; %</code></span>"}}))),(0,a.createElement)(d.PluginSidebarMoreMenuItem,{target:"consistency-custom-sidebar"},(0,l.__)("Consistency Settings","consistency")))}}),r()((()=>{document.querySelector(" #editor ")?.addEventListener("paste",(e=>{v=!0,e.preventDefault()})),(0,n.subscribe)((()=>{const e=(0,n.select)(s.store).getCurrentUser();if(!R("root","user",e?.id||0,"consistency_plugin_setting_state")?.meta?.consistency_plugin_setting_state[0])return;const t=R("root","site")?.consistency_plugin_settings;if(void 0===t)return;if(B=i.filter((e=>!0===t?.find((t=>t.slug===e.name))?.value)),v)return void(()=>{const e=C(),t=e.flatMap((e=>{let{innerBlocks:t,...n}=e;return t.map((e=>({...n,...e})))})),n=e.reduce(((e,t)=>{let n=t.attributes?.content;return Object.entries(B).forEach((e=>{let[s,o]=e;A.includes(t.name)&&void 0!==n&&m(o.name)&&(n=n.replaceAll(o.mask,o.replace))})),void 0!==n&&A.includes(t.name)?(e[t.clientId]={content:n},e):e}),{});Object.keys(n).length&&v&&(v=!1,x(Object.keys(n),n,!0)),t.forEach((e=>{A.includes(e.name)||e?.clientId&&M(e.clientId)})),t&&t[0]&&D(t[0]?.clientId,t[0]?.clientId)})();const o=N();null!==o&&B&&(e=>{const{currentBlockId:t,theRegs:n}=e,s=b(t);if(!c.includes(s))return;let o=k(t);o&&o.hasOwnProperty("content")&&""!==o.content&&Object.entries(n).forEach((e=>{let[n,r]=e;if(!r.mask.test(o.content)||!m(r.name))return;const c=0!==r.nbMoved,i=E(s);o.content=o.content.replaceAll(r.mask,r.replace),S(t,o),c&&r.nbMoved<0&&c&&w(t,i.attributeKey,i.offset-1,i.offset+r.nbMoved),c&&r.nbMoved>0&&c&&w(t,i.attributeKey,i.offset+1+r.nbMoved,i.offset+r.nbMoved)}))})({currentBlockId:o,theRegs:B})}))}))})();