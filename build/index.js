(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.plugins,n=window.wp.data,o=window.wp.coreData,s=window.wp.domReady;var i=e.n(s);const c=[{name:"quote",mask:/\'/g,replace:"’",nbMoved:0},{name:"ellipsis",mask:/\.{3}/g,replace:"…",nbMoved:-2},{name:"nonBreakingSpace",mask:/ (?=[\?|\!|\:|\;|\»|\€|\$|\£|\¥|\₽|\元|\%])/g,replace:" ",nbMoved:0}],r=window.wp.element,l=window.wp.i18n,a=window.wp.editPost,u=window.wp.components,d=window.wp.notices,p=()=>{const{currentUser:e}=(0,n.useSelect)((e=>({currentUser:e(o.store).getCurrentUser()})),[]),t=e&&e.id,[s,i]=(0,o.useEntityProp)("root","user","meta",t),{saveEditedEntityRecord:c}=(0,n.useDispatch)(o.store),{createNotice:a}=(0,n.useDispatch)(d.store);return(0,r.createElement)(u.ToggleControl,{label:(0,l.__)("Consistency correction","consistency"),help:(0,l.__)("Turn on/off autocorrect for my account","consistency"),checked:s?.consistency_plugin_setting_state[0]||!1,onChange:e=>{i({consistency_plugin_setting_state:[e]}),c("root","user",t,{consistency_plugin_setting_state:[e]}),a((0,l.__)("info","consistency"),e?(0,l.__)("Consistency correction is enabled","consistency"):(0,l.__)("Consistency correction is disabled","consistency"),{isDismissible:!0})}})},g=()=>{const[e,t]=(0,o.useEntityProp)("root","site","consistency_plugin_settings",void 0),{saveEditedEntityRecord:s}=(0,n.useDispatch)(o.store),{createNotice:i}=(0,n.useDispatch)(d.store);return(0,r.createElement)(u.ToggleControl,{label:(0,l.__)("Quote correction","consistency"),help:(0,l.__)("Replaces straight quotes (') with curved quotes (’)","consistency"),checked:e?.find((e=>"quote"===e.slug))?.value||!1,onChange:n=>{let o=e.map((e=>"quote"===e.slug?{...e,value:n}:e));o?.find((e=>"quote"===e.slug))||o.push({slug:"quote",value:n}),t(o),s("root","site",void 0,o),i((0,l.__)("info","consistency"),n?(0,l.__)("Quote correction is enabled","consistency"):(0,l.__)("Quote correction is disabled","consistency"),{isDismissible:!0})}})},y=()=>{const[e,t]=(0,o.useEntityProp)("root","site","consistency_plugin_settings",void 0),{saveEditedEntityRecord:s}=(0,n.useDispatch)(o.store),{createNotice:i}=(0,n.useDispatch)(d.store);return(0,r.createElement)(u.ToggleControl,{label:(0,l.__)("Ellipsis correction","consistency"),help:(0,l.__)("Replaces 3 successive dots with ellipsis","consistency"),checked:e?.find((e=>"ellipsis"===e.slug))?.value||!1,onChange:n=>{let o=e.map((e=>"ellipsis"===e.slug?{...e,value:n}:e));o?.find((e=>"ellipsis"===e.slug))||o.push({slug:"ellipsis",value:n}),t(o),s("root","site",void 0,o),i((0,l.__)("info","consistency"),n?(0,l.__)("Ellipsis correction is enabled","consistency"):(0,l.__)("Ellipsis correction is disabled","consistency"),{isDismissible:!0})}})},_=()=>{const[e,t]=(0,o.useEntityProp)("root","site","consistency_plugin_settings",void 0),{saveEditedEntityRecord:s}=(0,n.useDispatch)(o.store),{createNotice:i}=(0,n.useDispatch)(d.store);return(0,r.createElement)(u.ToggleControl,{label:(0,l.__)("Non-breaking space correction","consistency"),help:(0,l.__)("Replaces a breaking space followed by a character from this list [? ! : € $ %] with a non-breaking space","consistency"),checked:e?.find((e=>"nonBreakingSpace"===e.slug))?.value||!1,onChange:n=>{let o=e.map((e=>"nonBreakingSpace"===e.slug?{...e,value:n}:e));o?.find((e=>"nonBreakingSpace"===e.slug))||o.push({slug:"nonBreakingSpace",value:n}),t(o),s("root","site",void 0,o),i((0,l.__)("info","consistency"),n?(0,l.__)("Non-breaking space correction is enabled","consistency"):(0,l.__)("Non-breaking space correction is disabled","consistency"),{isDismissible:!0})}})},{canUser:m}=(0,n.select)("core"),{getBlockName:k,getBlockAttributes:b,getSelectionStart:h}=(0,n.select)("core/block-editor"),{updateBlock:E,selectionChange:w}=(0,n.dispatch)("core/block-editor"),v=["core/paragraph","core/heading","core/post-title"],f=["core/paragraph","core/heading","core/post-title"];let C=!1,B=[];const{getBlocks:P,getSelectedBlockClientId:S}=(0,n.select)("core/block-editor"),{getEntityRecord:R}=(0,n.select)("core"),{updateBlockAttributes:x}=(0,n.dispatch)("core/block-editor");(0,t.registerPlugin)("consistency-custom-sidebar",{icon:()=>(0,r.createElement)(u.Icon,{icon:(0,r.createElement)("svg",{version:"1.1",id:"consistency-plugin",x:"0px",y:"0px",width:"24px",height:"24px",viewBox:"0 0 24 24",enableBackground:"new 0 0 24 24"},(0,r.createElement)("line",{fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",x1:"4",y1:"20",x2:"7",y2:"20"}),(0,r.createElement)("line",{fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",x1:"14",y1:"20",x2:"21",y2:"20"}),(0,r.createElement)("line",{fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",x1:"6.9",y1:"15",x2:"13.8",y2:"15"}),(0,r.createElement)("line",{fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",x1:"10.2",y1:"6.3",x2:"16",y2:"20"}),(0,r.createElement)("polyline",{fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",points:"5,20 11,4 13,4 20,20 "}))}),render:()=>{const e=m("create","users");return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(a.PluginSidebar,{name:"consistency-custom-sidebar",title:(0,l.__)("Consistency Settings","consistency")},(0,r.createElement)(u.PanelBody,{title:(0,l.__)("Status","consistency"),initialOpen:!0},(0,r.createElement)(u.PanelRow,null,(0,r.createElement)(p,null))),e&&(0,r.createElement)(u.PanelBody,{title:(0,l.__)("Global Settings","consistency"),initialOpen:!0},(0,r.createElement)(u.PanelRow,null,(0,r.createElement)(g,null)),(0,r.createElement)(u.PanelRow,null,(0,r.createElement)(y,null)),(0,r.createElement)(u.PanelRow,null,(0,r.createElement)(_,null)))),(0,r.createElement)(a.PluginSidebarMoreMenuItem,{target:"consistency-custom-sidebar"},(0,l.__)("Consistency Settings","consistency")))}}),i()((()=>{document.querySelector(" #editor ")?.addEventListener("paste",(e=>{C=!0,e.preventDefault()})),(0,n.subscribe)((()=>{const e=(0,n.select)(o.store).getCurrentUser();if(!R("root","user",e?.id||0,"consistency_plugin_setting_state")?.meta?.consistency_plugin_setting_state[0])return;const t=R("root","site")?.consistency_plugin_settings;if(void 0===t)return;if(B=c.filter((e=>!0===t?.find((t=>t.slug===e.name))?.value)),C)return void(()=>{const e=P().reduce(((e,t)=>{let n=t.attributes?.content;return Object.entries(B).forEach((e=>{let[o,s]=e;f.includes(t.name)&&void 0!==n&&(n=n.replaceAll(s.mask,s.replace))})),e[t.clientId]={content:n},e}),{});Object.keys(e).length&&C&&(C=!1,x(Object.keys(e),e,!0))})();const s=S();null!==s&&(e=>{const{currentBlockId:t,theRegs:n}=e,o=k(t);if(!v.includes(o))return;let s=b(t);s&&s.hasOwnProperty("content")&&""!==s.content&&Object.entries(n).forEach((e=>{let[n,i]=e;if(!i.mask.test(s.content))return;const c=0!==i.nbMoved,r=h(o);s.content=s.content.replaceAll(i.mask,i.replace),E(t,s),c&&w(t,r.attributeKey,r.offset-1,r.offset+i.nbMoved)}))})({currentBlockId:s,theRegs:B})}))}))})();